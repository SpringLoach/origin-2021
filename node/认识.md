- 简单介绍
  + [Node_js简介](#Node_js简介)
    - [大量的库](#大量的库)
    - [Node_js应用程序的示例](#Node_js应用程序的示例)
    - [Node_js框架和工具](#Node_js框架和工具)
  + [Node_js与浏览器的区别](#Node_js与浏览器的区别)  
  + [报错处理_占用端口号](#报错处理_占用端口号)  
- 入门教程
  + [V8_JavaScript引擎](#V8_JavaScript引擎)
  + [从命令行运行Node_js脚本](#从命令行运行Node_js脚本)
  + [从Node_js程序退出](#从Node_js程序退出)
  + [读取环境变量](#读取环境变量)
  + [使用Node_js的REPL](#使用Node_js的REPL)
  + [从命令行接收参数](#从命令行接收参数)
  + [使用Node_js输出到命令行](#使用Node_js输出到命令行)
    - [使用控制台模块](#使用控制台模块)
    - [计算耗时](#计算耗时)
    - [为输出着色](#为输出着色)
    - [创建进度条](#创建进度条)

### Node_js简介    

索引 | 说明  
:-: | :-  
① | 开源与跨平台的 JavaScript 运行时环境
② | 在浏览器外运行 V8 JavaScript 引擎（Google Chrome 的内核）
③ | Node.js 应用程序运行于单个进程中，无需为每个请求创建新的线程  
④ | 其标准库中提供了一组异步的 I/O 原生功能，能防止 JavaScript 代码被阻塞
⑤ | Node.js 中的库通常是使用非阻塞的范式编写  
⑥ | 执行 I/O 操作时，会在响应返回时恢复操作，而不是阻塞线程并浪费 CPU 循环等待
⑦ | 这使 Node.js 可以在一台服务器上处理数千个并发连接，而无需引入管理线程并发的负担  
⑧ | 在高版本中，可以使用新的 ECMAScript 标准，而不用理浏览器  

#### 大量的库  

npm 的结构很简单，其仓库托管了众多可以自由使用的开源库包，有助于 Node.js 生态系统的激增。

#### Node_js应用程序的示例  
> Web服务器  

顺序 | 说明  
:-: | :-  
① | 引入 `http` 模块
② | `http` 的 createServer() 方法会创建新的 HTTP 服务器并返回它
③ | 服务器被设置为监听指定的端口和主机名。当服务器就绪后，回调函数会被调用
④ | 每当接收到新的请求时，request 事件回调会被调用，并提供请求和响应对象
⑤ | 这里设置了响应状态码、响应头
⑥ | 关闭响应，添加内容作为 `end()` 的参数
⑦ | 在命令行 `node 文件名` 启动服务器  

```
const http = require('http')

const hostname = '127.0.0.1'
const port = 3000

const server = http.createServer((req, res) => {
  res.statusCode = 200
  res.setHeader('Content-Type', 'text/plain')
  res.end('你好世界\n')
})

server.listen(port, hostname, () => {
  console.log(`服务器运行在 http://${hostname}:${port}/`)
})
```

#### Node_js框架和工具  

清单 | 描述 
:-: | :-  
Express | 提供了创建 Web 服务器的最简单但功能最强大的方法之一  


#### Node_js与浏览器的区别  

索引 | 环境 | 说明  
:-: | :- | :-   
① | Node.js | 使用单一语言轻松编程前端和后端
② | Node.js | 没有 document、window 等对象和 Web 平台 API（如Cookie）
② | 浏览器 | 没有模块提供的 API，如文件系统访问功能  
③ | Node.js | 可以控制运行环境，支持新技术
③ | 浏览器 | 发展较慢，用户升级慢，使用旧 JS/ES 版本
④ | 浏览器 | 使用 Babel 将代码转换为与 ES5 兼容的代码
④ | Node.js | 不需要
⑤ | Node.js | 使用 CommonJS 模块系统，即 `require()`
⑤ | 浏览器 | 实现 ES 模块标准，即 `import`

#### 报错处理_占用端口号  

索引 | 环境 | 命令  
:-: | :- | :-   
① | 打开cmd | /
② | 查询哪个程序占用该端口（这里举例3000） | netstat -nao \| findstr 3000
③ | 查看该进程 | tasklist \| findstr `对应PID`
④ | 终止该进程 | taskkill /pid `对应PID`
⑤ | 强杀该进程 | taskkill/F /pid `对应PID`

![占用端口号](./img/占用端口号.jpg)

----  

#### V8_JavaScript引擎    

索引 | 说明  
:-: | :-  
① | V8 是为 Google Chrome 提供支持的 JavaScript 引擎的名称。负责处理并执行 JS
② | V8 提供了执行 JavaScript 的运行时环境。 DOM 和其他 Web 平台 API 则由浏览器提供
③ | 使用 C++ 编写，并且不断地被改进
④ | JS 通常被认为是一门解释型的语言，但是现代的 JS 引擎不再只是解释 JS，也会对其进行编译
⑤ | JS 是由 V8 在其内部编译的，使用了**即时（JIT）编译**以加快执行速度

#### 从命令行运行Node_js脚本  

顺序 | 说明  
:-: | :-  
① | 确保[安装](https://nodejs.org/zh-cn/download/)了 node
② | `node 文件路径/文件名.js`

#### 从Node_js程序退出   
> `process` 模块无需引入，自动可用。

索引 | 方式 | 概述 | 说明  
:-: | :-: | :- | :- 
① | 控制台 | / | `ctrl-C`
② | 编程 | 强制终止 | `process.exit()`
② | 编程 | 强制终止 | 异常终止回调、请求、文件访问等
② | 编程 | 强制终止 | 可以传入一个整数，向操作系统发送[退出码](http://nodejs.cn/api/process.html#process_exit_codes)
② | 编程 | 强制终止 | 默认为 0，表示成功
③ | 编程 | 设置退出码 | `process.exitCode = 1`  
③ | 编程 | 设置退出码 | 当进程完成所有处理后，程序会正常地退出，并返回该退出码  
③ | 编程 | 正常终止 | [待学习](http://nodejs.cn/learn/how-to-exit-from-a-nodejs-program)  

#### 读取环境变量  

索引 | 说明  
:-: | :-  
① | 通过 `process.env.NODE_ENV` 可以读写环境变量   
② | 如 "development" 和 "production"
③ | :bug:获取不到默认值？

#### 使用Node_js的REPL  
> REPL 也被称为运行评估打印循环，是一种编程语言环境（主要是控制台窗口），它使用单个表达式作为用户输入，并在执行后将结果返回到控制台。  

索引 | 概述 | 命令行操作    
:-: | :- | :-   
① | 启用该模式 | `node`  
② | 自动补全 | 使用 `tab` 键，自动补全提示内容 
③ | 提示类属性和方法 | `Number.` + `tab`
④ | 提示全局对象 | `global.` + `tab`
⑤ | 打印最后操作结果 | `_`
⑥ | 退出 | `.exit` 或 `ctrl-c` 两次

#### 从命令行接收参数  

参数传递  
```
// 情况一：独立参数
node app.js joe  

// 情况二：键值对形式  
node app.js name=joe
```

获取参数     
> 通过 `process.argv` 这个数组，可以获取所有命令行调用参数。  

数组元素 | 说明  
:-: | :-  
第一个 | `node` 命令的完整路径 
第二个 | 正被执行的文件的完整路径
之后的 | 命令行的调用参数

获取参数二  
> 针对情况二，使用 [minimist](https://www.npmjs.com/package/minimist) 库，能更好的处理参数。  

顺序 | 说明  
:-: | :-  
① | 安装minimist库
② | 这种方法需要在每个参数前加双破折号
③ | 导入，取剩余数组作为参数  

```
npm install minimist -S

node app.js --name=joe

/* app.js */
const args = require('minimist')(process.argv.slice(2))
console.log(args['name']); //joe
```

#### 使用Node_js输出到命令行   

概述 | 说明 | 代码     
:- | :- | :-      
[控制台模块](http://nodejs.cn/api/console.html)的**基础**输出 | 最简单的输出 | `console.log()`
清空控制台显示 | 让当前区域干净 | `console.clear()`
元素计数 | 同时输出该字符串的输出次数，全等则加一 | `console.count()`
计算耗时 | 可以计算并输出[被夹函数](#计算耗时)的执行时间 | `console.time()`、`console.timeEnd()`
stdout | 标准输出 | `console.log()`
stderr | 出现在错误日志 | `console.error`  
[为输出着色](#为输出着色) | 演示输出黄色的底层方法 | `console.log('\x1b[33m%s\x1b[0m', '你好')`
创建进度条 | 需要安装导入 `progress` 库 | [跳转](#创建进度条)  

#### 使用控制台模块  
> 这样会将后面参数改变格式后添加到首参。  
```
console.log('我的%s已经%d岁', '猫', 2)

// 我的猫已经2岁
```

- `%s` 会格式化变量为字符串
- `%d` 会格式化变量为数字
- `%i` 会格式化变量为其整数部分
- `%o` 会格式化变量为对象

#### 计算耗时  

```
const doSomething = () => console.log('测试')
const measureDoingSomething = () => {
  console.time('doSomething()')
  doSomething()
  console.timeEnd('doSomething()')
}
measureDoingSomething()
```

#### 为输出着色  
> **安装**并导入 `Chalk` 库，还能设置其他样式，如粗体、斜体或带下划线。   

```
const chalk = require('chalk')

console.log(chalk.yellow('你好'))
```

#### 创建进度条  
> 创建一个 10 步的进度条，每 100 毫秒完成一步。当进度条结束时，则清除定时器。  

```
const ProgressBar = require('progress')

const bar = new ProgressBar(':bar', { total: 10 })
const timer = setInterval(() => {
  bar.tick()
  if (bar.complete) {
    clearInterval(timer)
  }
}, 100)
```

#### 从命令行接收输入  

`readline` 模块，每次一行地从可读流（例如 process.stdin 流，在 Node.js 程序执行期间该流就是终端输入）获取输入。



`question()` 方法的首参为问题，用户输入内容并按下回车时，执行回调。  
```
const readline = require('readline').createInterface({
  input: process.stdin,
  output: process.stdout
})

readline.question(`你叫什么名字?`, name => {
  console.log(`你好 ${name}!`)
  readline.close()
})
```





